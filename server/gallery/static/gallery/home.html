<head>
	 <!-- Favicon.ico and apple-touch-icon.png (according to Apple docs). A good tool is http://iconifier.net/ -->
        <link rel="shortcut icon" href="assets/ico/favicon.ico">
        <link rel="apple-touch-icon" href="touch-icon-iphone.png" />
        <link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png" />
        <link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png" />
        <link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png" />

        <!-- CSS, Normalize First, minify for production -->
        <link rel="stylesheet" type='text/css' href="less/master.css"/>
        
        <!-- Import web fonts using the link tag instead of CSS @import -->
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400,900' rel='stylesheet' type='text/css'>
        
        <!-- Icons from http://fontawesome.io/ -->
        <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"/>

        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script type="text/javascript" src="https://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
        <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
                
</head>

<body>

		<header id="main-header-home">
            <div class="container">
                <h1>Your Analytics</h1>
                <p>Welcome back!</p>
            </div>
		</header>

        <section id="graphs">
        		<div class="container">
        			<article class="cf">
                    <div class="img-graph-div">
                        
                        <h3>Pieces by Veiw Count</h3>
                        <div  class="barContainer">
                        </div>
                        <script type="text/javascript">
                            // Your beautiful D3 code will go here
                            var dataset = [];
                            for (var i=0; i < 50; i++){
                                var newNumber = Math.round(Math.random() * 30);
                                dataset.push(newNumber);
                            }
                            var svg = d3.select(".barContainer").append("svg");

                                svg.selectAll("rect") 
                                .data(dataset)
                                .enter()
                                .append("rect")
                                //.text(function(d) { return d; });
                                .attr("class", "bar")
                                .style("fill", "pink")
                                .attr("width", 13)
                                .attr("height", function(d) {
                                    return d * 6 + "px";
                                })
                                .attr("x",function(d,i){return 6*i;})
                                .attr("y",0);
                        </script>
                        <p>How many people veiwed each piece.</p>
                    </div>
                    <div class="img-graph-div">
                        
                        <h3>Overall Time Spent</h3>
                        <div id="chart"></div>
                        <script type="text/javascript">
                        var w = 400;
                        var h = 400;
                        var r = h/2;
                        var color = d3.scale.category20c();

                        var data = [{"label":"Olympia", "value":30}, 
                                          {"label":"Nana", "value":20}, 
                                          {"label":"La Grande Jatte", "value":50}];


                        var vis = d3.select('#chart').append("svg:svg").data([data]).attr("width", w).attr("height", h).append("svg:g").attr("transform", "translate(" + r + "," + r + ")");
                        var pie = d3.layout.pie().value(function(d){return d.value;});

                        // declare an arc generator function
                        var arc = d3.svg.arc().outerRadius(r);

                        // select paths, use arc generator to draw
                        var arcs = vis.selectAll("g.slice").data(pie).enter().append("svg:g").attr("class", "slice");
                        arcs.append("svg:path")
                            .attr("fill", function(d, i){
                                return color(i);
                            })
                            .attr("d", function (d) {
                                // log the result of the arc generator to show how cool it is :)
                                console.log(arc(d));
                                return arc(d);
                            });

                        // add the text
                        arcs.append("svg:text").attr("transform", function(d){
                                    d.innerRadius = 0;
                                    d.outerRadius = r;
                            return "translate(" + arc.centroid(d) + ")";}).attr("text-anchor", "middle").text( function(d, i) {
                            return data[i].label;}
                                );


                        </script>
                        <p>Overall veiwing breakdown by piece.</p>
                    </div>
                    <div class="img-graph-div">
                        
                        <h3>User Mapping</h3>
                        <div class="bundleChart">
                        </div>
                        <script>

                        var diameter = 960,
                            radius = diameter / 2,
                            innerRadius = radius - 120;

                        var cluster = d3.layout.cluster()
                            .size([360, innerRadius])
                            .sort(null)
                            .value(function(d) { return d.size; });

                        var bundle = d3.layout.bundle();

                        var line = d3.svg.line.radial()
                            .interpolate("bundle")
                            .tension(.85)
                            .radius(function(d) { return d.y; })
                            .angle(function(d) { return d.x / 180 * Math.PI; });

                        var svg = d3.select("bundleChart").append("svg")
                            .attr("width", diameter)
                            .attr("height", diameter)
                          .append("g")
                            .attr("transform", "translate(" + radius + "," + radius + ")");

                        d3.json("readme-flare-imports.json", function(error, classes) {
                          var nodes = cluster.nodes(packageHierarchy(classes)),
                              links = packageImports(nodes);

                          svg.selectAll(".link")
                              .data(bundle(links))
                            .enter().append("path")
                              .attr("class", "link")
                              .attr("d", line);

                          svg.selectAll(".node")
                              .data(nodes.filter(function(n) { return !n.children; }))
                            .enter().append("g")
                              .attr("class", "node")
                              .attr("transform", function(d) { return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")"; })
                            .append("text")
                              .attr("dx", function(d) { return d.x < 180 ? 8 : -8; })
                              .attr("dy", ".31em")
                              .attr("text-anchor", function(d) { return d.x < 180 ? "start" : "end"; })
                              .attr("transform", function(d) { return d.x < 180 ? null : "rotate(180)"; })
                              .text(function(d) { return d.key; });
                        });

                        d3.select(self.frameElement).style("height", diameter + "px");

                        // Lazily construct the package hierarchy from class names.
                        function packageHierarchy(classes) {
                          var map = {};

                          function find(name, data) {
                            var node = map[name], i;
                            if (!node) {
                              node = map[name] = data || {name: name, children: []};
                              if (name.length) {
                                node.parent = find(name.substring(0, i = name.lastIndexOf(".")));
                                node.parent.children.push(node);
                                node.key = name.substring(i + 1);
                              }
                            }
                            return node;
                          }

                          classes.forEach(function(d) {
                            find(d.name, d);
                          });

                          return map[""];
                        }

                        // Return a list of imports for the given array of nodes.
                        function packageImports(nodes) {
                          var map = {},
                              imports = [];

                          // Compute a map from name to node.
                          nodes.forEach(function(d) {
                            map[d.name] = d;
                          });

                          // For each import, construct a link from the source to target node.
                          nodes.forEach(function(d) {
                            if (d.imports) d.imports.forEach(function(i) {
                              imports.push({source: map[d.name], target: map[i]});
                            });
                          });

                          return imports;
                        }

                        </script>
                        <p>Mapping of veiwer trajectory.</p>
                    </div>
                    <div class="img-graph-div">
                        
                        <h3>Average Time Spent</h3>
                        <div  class="barContainer2">
                        </div>
                        <script type="text/javascript">
                          // Your beautiful D3 code will go here
                            var dataset = [];
                            for (var i=0; i < 50; i++){
                                var newNumber = Math.round(Math.random() * 30);
                                dataset.push(newNumber);
                            }
                            var svg = d3.select(".barContainer2").append("svg");

                                svg.selectAll("rect") 
                                .data(dataset)
                                .enter()
                                .append("rect")
                                //.text(function(d) { return d; });
                                .attr("class", "bar")
                                .style("fill", "green")
                                .attr("width", 15)
                                .attr("height", function(d) {
                                    return d * 6 + "px";
                                })
                                .attr("x",function(d,i){return 6*i;})
                                .attr("y",0);

                        </script>
                        <p>Length of the average time spent, by piece.</p>
                    </div>
                </article>
        		</div>
        </section>
        <section class="call-to-action">
            <div class="cta-container cf">
                <p>Need Help? </p>
                <a class="btn" href="mailto:mgalemmo@gmail.com">Contact us!</a>
            </div>
        </section>
 </body>